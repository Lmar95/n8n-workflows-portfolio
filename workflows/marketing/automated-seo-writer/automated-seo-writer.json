{
  "name": "RÃ©daction Articles SEO AutomatisÃ©e avec Analyse SÃ©mantique",
  "nodes": [
    {
      "parameters": {
        "content": "## âœï¸ RÃ©daction Articles SEO AutomatisÃ©e\n\n**Objectif :** Ã€ partir d'un mot-clÃ©, analyser les top 10 Google, extraire le champ sÃ©mantique et gÃ©nÃ©rer un article 1500-2500 mots optimisÃ© SEO avec images DALL-E. Publication automatique sur WordPress.\n\n**DÃ©clenchement :** Webhook (POST) avec `{\"keyword\": \"votre mot-clÃ© cible\", \"publish\": true}`\n\n**Configuration requise :**\n- OpenAI API Key (GPT-4 + DALL-E 3)\n- DataforSEO API credentials\n- Apify API Token (`$vars.APIFY_TOKEN`)\n- WordPress site URL + credentials\n- `$vars.WORDPRESS_URL`, `$vars.WORDPRESS_USER`, `$vars.WORDPRESS_APP_PASSWORD`",
        "height": 300,
        "width": 480
      },
      "id": "sticky-doc",
      "name": "ğŸ“‹ Documentation",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [0, 0]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "seo-article-generator",
        "responseMode": "lastNode",
        "options": {}
      },
      "id": "webhook-trigger",
      "name": "ğŸŒ Webhook - Mot-ClÃ© Cible",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [560, 340]
    },
    {
      "parameters": {
        "jsCode": "// Validate and prepare keyword\nconst body = $input.first().json.body || $input.first().json;\nconst keyword = body.keyword || body.query || '';\nconst shouldPublish = body.publish !== false;\n\nif (!keyword) {\n  throw new Error('Keyword is required. Send POST with {\"keyword\": \"your keyword\"}');\n}\n\nreturn [{\n  json: {\n    keyword: keyword.toLowerCase().trim(),\n    originalKeyword: keyword,\n    shouldPublish,\n    language: body.language || 'fr',\n    targetLength: body.targetLength || 2000,\n    requestedAt: new Date().toISOString()\n  }\n}];"
      },
      "id": "validate-input",
      "name": "âœ… Valider et PrÃ©parer DonnÃ©es",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [800, 340]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.dataforseo.com/v3/serp/google/organic/live/advanced",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBasicAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "=[{\"keyword\": \"{{ $json.keyword }}\",\"language_code\": \"fr\",\"location_code\": 2250,\"device\": \"desktop\",\"depth\": 10}]"
      },
      "id": "serp-analysis",
      "name": "ğŸ” Analyser Top 10 Google (DataforSEO)",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1040, 200]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.dataforseo.com/v3/keywords_data/google/search_volume/live",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBasicAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "=[{\"keywords\": [\"{{ $json.keyword }}\"],\"language_code\": \"fr\",\"location_code\": 2250}]"
      },
      "id": "keyword-data",
      "name": "ğŸ“Š Volume & DifficultÃ© Mot-ClÃ©",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1040, 480]
    },
    {
      "parameters": {
        "jsCode": "// Extract and analyze SERP data to build semantic field\nconst serpData = $('ğŸ” Analyser Top 10 Google (DataforSEO)').item.json;\nconst kwData = $('ğŸ“Š Volume & DifficultÃ© Mot-ClÃ©').item.json;\nconst keyword = $('âœ… Valider et PrÃ©parer DonnÃ©es').item.json.keyword;\n\n// Extract top results\nconst results = serpData.tasks?.[0]?.result?.[0]?.items || [];\nconst organicResults = results.filter(r => r.type === 'organic').slice(0, 10);\n\n// Build content structure analysis\nconst competitorInsights = organicResults.map((r, i) => ({\n  position: i + 1,\n  title: r.title || '',\n  description: r.description || '',\n  url: r.url || '',\n  wordCountEstimate: Math.round((r.description?.length || 0) * 10)\n}));\n\n// Extract PAA questions\nconst paaItems = results.filter(r => r.type === 'people_also_ask');\nconst questions = paaItems.flatMap(p => (p.items || []).map(q => q.title)).slice(0, 8);\n\n// Keyword data\nconst kwResult = kwData.tasks?.[0]?.result?.[0];\nconst searchVolume = kwResult?.search_volume || 0;\nconst difficulty = kwResult?.keyword_properties?.keyword_difficulty || 0;\n\nreturn [{\n  json: {\n    keyword,\n    searchVolume,\n    difficulty,\n    competitorInsights,\n    questions,\n    topUrls: organicResults.slice(0, 5).map(r => r.url),\n    serpFeatures: [...new Set(results.map(r => r.type))].filter(t => t !== 'organic')\n  }\n}];"
      },
      "id": "build-semantic",
      "name": "âš™ï¸ Construire Champ SÃ©mantique",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1280, 340]
    },
    {
      "parameters": {
        "model": "gpt-4o",
        "messages": {
          "values": [
            {
              "role": "system",
              "content": "Tu es un expert SEO et rÃ©dacteur web senior. Tu crÃ©es des contenus optimisÃ©s SEO qui se positionnent en premiÃ¨re page de Google. Tu rÃ©diges en franÃ§ais avec un style engageant et expert."
            },
            {
              "role": "user",
              "content": "=GÃ©nÃ¨re un article SEO complet sur le mot-clÃ©: \"{{ $json.keyword }}\"\n\nContexte:\n- Volume de recherche: {{ $json.searchVolume }}/mois\n- DifficultÃ© SEO: {{ $json.difficulty }}/100\n\nQuestions PAA Ã  intÃ©grer:\n{{ $json.questions.map((q, i) => (i+1) + '. ' + q).join('\\n') }}\n\nTop concurrents Ã  battre:\n{{ $json.competitorInsights.slice(0, 5).map(c => c.position + '. ' + c.title).join('\\n') }}\n\nRÃ©dige un article de 1800-2200 mots avec:\n- Title tag H1 (60 chars max, inclut le mot-clÃ©)\n- Introduction engageante avec le mot-clÃ© dans les 100 premiers mots\n- Structure H2/H3 logique qui rÃ©pond aux questions PAA\n- Champ sÃ©mantique enrichi (LSI keywords naturellement intÃ©grÃ©s)\n- Exemples concrets et donnÃ©es chiffrÃ©es\n- Section FAQ (5 questions/rÃ©ponses)\n- Conclusion avec CTA\n- Meta description (155 chars max)\n\nFormat JSON:\n{\n  \"metaTitle\": \"...\",\n  \"metaDescription\": \"...\",\n  \"slug\": \"url-slug-optimise\",\n  \"content\": \"contenu HTML complet avec balises h1, h2, h3, p, ul, strong...\",\n  \"imagePrompt\": \"prompt DALL-E pour image principale (en anglais)\",\n  \"tags\": [\"tag1\", \"tag2\"],\n  \"focusKeyphrase\": \"...\",\n  \"wordCount\": 0\n}"
            }
          ]
        },
        "options": {
          "maxTokens": 4000,
          "response_format": { "type": "json_object" }
        }
      },
      "id": "generate-article",
      "name": "âœï¸ GÃ©nÃ©rer Article SEO (GPT-4)",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.4,
      "position": [1520, 340]
    },
    {
      "parameters": {
        "jsCode": "// Parse the AI response\nconst aiResponse = $input.first().json;\nconst content = aiResponse.message?.content || aiResponse.choices?.[0]?.message?.content || '{}';\n\nlet article;\ntry {\n  article = JSON.parse(content);\n} catch(e) {\n  // Fallback if not JSON\n  article = {\n    metaTitle: $('âœ… Valider et PrÃ©parer DonnÃ©es').item.json.keyword,\n    metaDescription: '',\n    slug: $('âœ… Valider et PrÃ©parer DonnÃ©es').item.json.keyword.replace(/\\s+/g, '-'),\n    content: content,\n    imagePrompt: 'professional business article cover image',\n    tags: [],\n    wordCount: content.split(' ').length\n  };\n}\n\n// Count words\narticle.wordCount = article.content?.replace(/<[^>]+>/g, '').split(/\\s+/).length || 0;\n\nreturn [{ json: { ...article, keyword: $('âœ… Valider et PrÃ©parer DonnÃ©es').item.json.keyword } }];"
      },
      "id": "parse-article",
      "name": "ğŸ“„ Parser Article GÃ©nÃ©rÃ©",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1760, 340]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.openai.com/v1/images/generations",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "openAiApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\"model\": \"dall-e-3\",\"prompt\": \"{{ $json.imagePrompt || 'Professional business article hero image, modern, clean design' }}, photorealistic, high quality, 16:9 ratio\",\"n\": 1,\"size\": \"1792x1024\",\"quality\": \"standard\"}"
      },
      "id": "generate-image",
      "name": "ğŸ¨ GÃ©nÃ©rer Image DALL-E 3",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [2000, 200]
    },
    {
      "parameters": {
        "conditions": {
          "conditions": [
            {
              "leftValue": "={{ $('âœ… Valider et PrÃ©parer DonnÃ©es').item.json.shouldPublish }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equal"
              }
            }
          ]
        }
      },
      "id": "check-publish",
      "name": "ğŸš€ Publier sur WordPress?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [2000, 480]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $vars.WORDPRESS_URL }}/wp-json/wp/v2/posts",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBasicAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"title\": \"{{ $('ğŸ“„ Parser Article GÃ©nÃ©rÃ©').item.json.metaTitle }}\",\n  \"content\": \"{{ $('ğŸ“„ Parser Article GÃ©nÃ©rÃ©').item.json.content }}\",\n  \"status\": \"publish\",\n  \"slug\": \"{{ $('ğŸ“„ Parser Article GÃ©nÃ©rÃ©').item.json.slug }}\",\n  \"excerpt\": \"{{ $('ğŸ“„ Parser Article GÃ©nÃ©rÃ©').item.json.metaDescription }}\",\n  \"meta\": {\n    \"_yoast_wpseo_title\": \"{{ $('ğŸ“„ Parser Article GÃ©nÃ©rÃ©').item.json.metaTitle }}\",\n    \"_yoast_wpseo_metadesc\": \"{{ $('ğŸ“„ Parser Article GÃ©nÃ©rÃ©').item.json.metaDescription }}\",\n    \"_yoast_wpseo_focuskw\": \"{{ $('ğŸ“„ Parser Article GÃ©nÃ©rÃ©').item.json.focusKeyphrase }}\"\n  },\n  \"tags\": {{ JSON.stringify($('ğŸ“„ Parser Article GÃ©nÃ©rÃ©').item.json.tags) }}\n}"
      },
      "id": "publish-wordpress",
      "name": "ğŸŒ Publier sur WordPress",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [2240, 380]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"success\": true,\n  \"keyword\": \"{{ $('ğŸ“„ Parser Article GÃ©nÃ©rÃ©').item.json.keyword }}\",\n  \"wordCount\": {{ $('ğŸ“„ Parser Article GÃ©nÃ©rÃ©').item.json.wordCount }},\n  \"title\": \"{{ $('ğŸ“„ Parser Article GÃ©nÃ©rÃ©').item.json.metaTitle }}\",\n  \"published\": {{ $('âœ… Valider et PrÃ©parer DonnÃ©es').item.json.shouldPublish }},\n  \"wordpressUrl\": \"{{ $json.link || '' }}\",\n  \"metaDescription\": \"{{ $('ğŸ“„ Parser Article GÃ©nÃ©rÃ©').item.json.metaDescription }}\"\n}"
      },
      "id": "respond-success",
      "name": "âœ… RÃ©pondre SuccÃ¨s",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [2480, 340]
    }
  ],
  "connections": {
    "ğŸŒ Webhook - Mot-ClÃ© Cible": {
      "main": [[{ "node": "âœ… Valider et PrÃ©parer DonnÃ©es", "type": "main", "index": 0 }]]
    },
    "âœ… Valider et PrÃ©parer DonnÃ©es": {
      "main": [
        [
          { "node": "ğŸ” Analyser Top 10 Google (DataforSEO)", "type": "main", "index": 0 },
          { "node": "ğŸ“Š Volume & DifficultÃ© Mot-ClÃ©", "type": "main", "index": 0 }
        ]
      ]
    },
    "ğŸ” Analyser Top 10 Google (DataforSEO)": {
      "main": [[{ "node": "âš™ï¸ Construire Champ SÃ©mantique", "type": "main", "index": 0 }]]
    },
    "ğŸ“Š Volume & DifficultÃ© Mot-ClÃ©": {
      "main": [[{ "node": "âš™ï¸ Construire Champ SÃ©mantique", "type": "main", "index": 1 }]]
    },
    "âš™ï¸ Construire Champ SÃ©mantique": {
      "main": [[{ "node": "âœï¸ GÃ©nÃ©rer Article SEO (GPT-4)", "type": "main", "index": 0 }]]
    },
    "âœï¸ GÃ©nÃ©rer Article SEO (GPT-4)": {
      "main": [[{ "node": "ğŸ“„ Parser Article GÃ©nÃ©rÃ©", "type": "main", "index": 0 }]]
    },
    "ğŸ“„ Parser Article GÃ©nÃ©rÃ©": {
      "main": [
        [
          { "node": "ğŸ¨ GÃ©nÃ©rer Image DALL-E 3", "type": "main", "index": 0 },
          { "node": "ğŸš€ Publier sur WordPress?", "type": "main", "index": 0 }
        ]
      ]
    },
    "ğŸš€ Publier sur WordPress?": {
      "main": [
        [{ "node": "ğŸŒ Publier sur WordPress", "type": "main", "index": 0 }],
        [{ "node": "âœ… RÃ©pondre SuccÃ¨s", "type": "main", "index": 0 }]
      ]
    },
    "ğŸŒ Publier sur WordPress": {
      "main": [[{ "node": "âœ… RÃ©pondre SuccÃ¨s", "type": "main", "index": 0 }]]
    }
  },
  "settings": { "executionOrder": "v1" },
  "tags": [{ "name": "marketing" }, { "name": "seo" }, { "name": "content" }, { "name": "wordpress" }]
}
